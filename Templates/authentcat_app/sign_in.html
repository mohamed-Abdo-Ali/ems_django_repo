{% extends 'base.html' %}

{% load static %}

<!-- #region__________________________________________________________بداية عنوان الصفحة ___________________________________________________--> 
{% block title %} تسجيل الدخول | EMS  {% endblock %}
<!-- #endregion_______________________________________________________نهاية عنوان الصفحة ___________________________________________________--> 

<!-- #region____________________________________________________css ا بداية لاضافي للصفحة ___________________________________________________--> 
{% block extra_css %}
<style>
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-15px); }
    }
    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.5; }
    }
    .animate-form {
        animation: fadeIn 0.6s ease-out forwards;
    }
    .input-error {
        animation: pulse 1.5s ease-in-out infinite;
    }


</style>
{% endblock extra_css%}
<!-- #endregion_________________________________________________css ا نهاية لاضافي للصفحة ___________________________________________________--> 


<!-- #region-------------------------------------------------------بداية الهيدر -------------------------------------------------------------->
    {% block navbar_block %}
    {% endblock navbar_block %} 
<!-- #endregion----------------------------------------------------نهاية الهيدر -------------------------------------------------------------->



<!-- #region_______________________________________________________بداية محتوي الصفحة_______________________________________________________-->
{% block content %}
<div class="min-h-screen flex items-center justify-center bg-gradient-to-br p-0">


    <!-- #region_____________بداية العناصر الخلفية المتحركة_______________-->
    <div class="absolute top-1/4 left-1/4 w-32 h-32 bg-blue-200 rounded-full opacity-20 animate-[float_6s_ease-in-out_infinite]"></div>
    <div class="absolute bottom-1/4 right-1/4 w-40 h-40 bg-indigo-200 rounded-full opacity-20 animate-[float_8s_ease-in-out_infinite]"></div>
    <div class="absolute top-3/4 left-1/4 w-32 h-32 bg-blue-200 rounded-full opacity-20 animate-[float_6s_ease-in-out_infinite]"></div>
    <!-- #endregion__________بداية العناصر الخلفية المتحركة_______________-->


    <div class="bg-white p-3 py-3 px-7 rounded-xl shadow-xl w-full max-w-md z-10 backdrop-blur-sm bg-opacity-90 animate-form ">
        <!-- شعار الجامعة -->
        <div class="flex justify-center mb-6 transform transition-all duration-300 hover:scale-105">
            <img 
                src="{% static 'img/tize_unvercity_logo.svg' %}" 
                alt="شعار الجامعة" 
                class="h-24 w-24 object-contain drop-shadow-md">
        </div>
        
        <h1 class="text-2xl font-bold text-center text-blue-800 mb-6 animate-[fadeIn_0.8s_ease-out]">نظام الامتحانات الإلكترونية</h1>
        
        <form method="POST" class="space-y-5"  id="loginForm">
            {% csrf_token %}
            



            <!-- حقل اسم المستخدم -->
            <div class="animate-[fadeIn_0.6s_ease-out_0.2s_backwards]">
                <label for="username" class="block text-gray-700 mb-2 font-medium flex items-center">
                    اسم المستخدم
                </label>
                <div class="relative group">
                    <input 
                        type="text" 
                        id="username" 
                        name="username"
                        class="w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300 group-hover:shadow-sm"
                        placeholder="أدخل اسم المستخدم"
                        required>
                    <div class="absolute inset-0 border-2 border-transparent group-hover:border-blue-200 rounded-lg pointer-events-none transition-all duration-300"></div>
                    <div class="absolute left-3 top-3 text-gray-400">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                        </svg>
                    </div>
                    <div id="usernameValidIcon" class="absolute right-3 top-3 hidden">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-500" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                        </svg>
                    </div>
                </div>
            </div>
            
            <!-- حقل كلمة المرور -->
            <div class="animate-[fadeIn_0.6s_ease-out_0.3s_backwards]">
                <label for="password" class="block text-gray-700 mb-2 font-medium flex items-center">
                    كلمة المرور
                </label>
                <div class="relative group">
                    <input 
                        type="password" 
                        id="password" 
                        name="password"
                        class="w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300 group-hover:shadow-sm"
                        placeholder="أدخل كلمة المرور"
                        required>
                    <div class="absolute inset-0 border-2 border-transparent group-hover:border-blue-200 rounded-lg pointer-events-none transition-all duration-300"></div>
                    <!-- زر إظهار/إخفاء كلمة المرور -->
                  <button 
                    type="button" 
                    id="togglePassword" 
                    class="absolute left-3 top-3 text-gray-500 hover:text-blue-600 focus:outline-none transition-colors duration-200 opacity-100 visible">
                    <!-- أيقونة العين المغلقة (الافتراضية) -->
                    <svg id="eyeOffIcon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21" />
                    </svg>
                    <!-- أيقونة العين المفتوحة (مخفية افتراضياً) -->
                    <svg id="eyeIcon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                    </svg>
                </button>
                    <div id="passwordValidIcon" class="absolute right-3 top-3 hidden">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-500" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                        </svg>
                    </div>
                </div>
            </div>


            <!-- خيار تذكر كلمة المرور -->
                <div class="remember-me-container">
                <!-- العنصر الرئيسي -->
                <label class="remember-me-label">
                    <!-- مربع الاختيار المخصص -->
                    <span class="custom-checkbox">
                    <input type="checkbox" class="hidden-checkbox" name="remember_me">
                    <span class="checkmark">
                        <svg viewBox="0 0 24 24" class="check-icon">
                        <path d="M20 6L9 17l-5-5"/>
                        </svg>
                    </span>
                    </span>
                    
                    <!-- نص "تذكرني" -->
                    <span class="remember-text">تذكرني</span>
                </label>
                </div>

                <style>
                .remember-me-container {
                    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                    padding: 12px 0;
                }

                .remember-me-label {
                    display: flex;
                    align-items: center;
                    cursor: pointer;
                    position: relative;
                    user-select: none;
                }

                .custom-checkbox {
                    position: relative;
                    margin-left: 8px;
                }

                .hidden-checkbox {
                    position: absolute;
                    opacity: 0;
                    cursor: pointer;
                    height: 0;
                    width: 0;
                }

                .checkmark {
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    height: 20px;
                    width: 20px;
                    border: 2px solid #ccc;
                    border-radius: 4px;
                    transition: all 0.3s ease;
                    background-color: white;
                }

                .check-icon {
                    width: 14px;
                    height: 14px;
                    fill: none;
                    stroke: white;
                    stroke-width: 3;
                    stroke-linecap: round;
                    stroke-linejoin: round;
                    opacity: 0;
                    transform: scale(0.8);
                    transition: all 0.2s ease;
                }

                .hidden-checkbox:checked ~ .checkmark {
                    background-color: #4CAF50;
                    border-color: #4CAF50;
                }

                .hidden-checkbox:checked ~ .checkmark .check-icon {
                    opacity: 1;
                    transform: scale(1);
                }

                .remember-text {
                    font-size: 14px;
                    color: #333;
                    margin-left: 8px;
                    transition: color 0.2s ease;
                }

                .remember-me-label:hover .remember-text {
                    color: #000;
                }

                .info-icon {
                    margin-left: 8px;
                    position: relative;
                    display: flex;
                    align-items: center;
                }

                .info-icon svg {
                    width: 16px;
                    height: 16px;
                    stroke: #888;
                    stroke-width: 2;
                    fill: none;
                    transition: stroke 0.2s ease;
                }

                .remember-me-label:hover .info-icon svg {
                    stroke: #555;
                }

                .tooltip {
                    position: absolute;
                    bottom: 100%;
                    left: 50%;
                    transform: translateX(-50%);
                    background-color: #333;
                    color: white;
                    padding: 6px 10px;
                    border-radius: 4px;
                    font-size: 12px;
                    white-space: nowrap;
                    opacity: 0;
                    visibility: hidden;
                    transition: all 0.2s ease;
                    margin-bottom: 8px;
                }

                .info-icon:hover .tooltip {
                    opacity: 1;
                    visibility: visible;
                }

                /* تأثيرات الحركة */
                .remember-me-label:hover .checkmark {
                    transform: scale(1.05);
                    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                }

                .hidden-checkbox:active ~ .checkmark {
                    transform: scale(0.95);
                }
                </style>


            

















            
            <!-- زر الدخول -->
            <div class="pt-2 animate-[fadeIn_0.6s_ease-out_0.5s_backwards]">
                <button 
                    type="submit" 
                    id="submitBtn"
                    name="login_button_template"
                    class="w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold py-3 px-4 rounded-lg transition-all duration-300 transform hover:scale-[1.02] active:scale-95 shadow-md hover:shadow-lg flex items-center justify-center disabled:opacity-70 disabled:cursor-not-allowed">
                    <span id="btnText">الدخول</span>
                    <svg id="btnSpinner" class="h-5 w-5 mr-2 hidden animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <svg id="btnIcon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1" />
                    </svg>
                </button>
            </div>

            <!-- رابط نسيت كلمة المرور -->
            <div class="text-center animate-[fadeIn_0.6s_ease-out_0.6s_backwards]">
                <a href="{% url 'authentcat_app:password_reset' %}" class="text-blue-600 hover:text-blue-800 text-sm hover:underline transition-all duration-200">نسيت كلمة المرور؟</a>
            </div>
        </form>
        <!-- {% if messages %}
            {% for message in messages %}
                <div class="ml-3 flex-1">
                    <p class="text-sm font-medium">{{ message }}</p>
                </div>
            {% endfor %}
        {% endif %} -->
            {% include "../includes/messages.html" %}

    </div>
</div>

<script>
// عناصر DOM
const usernameInput = document.getElementById('username');
const usernameValidIcon = document.getElementById('usernameValidIcon');
const passwordInput = document.getElementById('password');
const passwordValidIcon = document.getElementById('passwordValidIcon');
const togglePassword = document.getElementById('togglePassword');
const eyeIcon = document.getElementById('eyeIcon');
const eyeOffIcon = document.getElementById('eyeOffIcon');
const submitBtn = document.getElementById('submitBtn');
const btnText = document.getElementById('btnText');
const btnSpinner = document.getElementById('btnSpinner');
const btnIcon = document.getElementById('btnIcon');


// وظيفة إظهار/إخفاء كلمة المرور
togglePassword.addEventListener('click', function() {
    const isPassword = passwordInput.type === 'password';
    passwordInput.type = isPassword ? 'text' : 'password';
    eyeIcon.classList.toggle('hidden', !isPassword);
    eyeOffIcon.classList.toggle('hidden', isPassword);
});

// التحقق من صحة اسم المستخدم أثناء الكتابة
usernameInput.addEventListener('input', function(e) {
    if (usernameInput.value.length > 0) {
        usernameInput.classList.add('border-green-500', 'focus:ring-green-500', 'focus:border-green-500');
        usernameInput.classList.remove('border-red-500', 'focus:ring-red-500', 'focus:border-red-500');
        usernameValidIcon.classList.remove('hidden');
    } else {
        usernameInput.classList.add('border-red-500', 'focus:ring-red-500', 'focus:border-red-500');
        usernameInput.classList.remove('border-green-500', 'focus:ring-green-500', 'focus:border-green-500');
        usernameValidIcon.classList.add('hidden');
    }
    checkFormValidity();
});

// التحقق من صحة كلمة المرور أثناء الكتابة
passwordInput.addEventListener('input', function(e) {
    if (passwordInput.value.length > 0) {
        passwordInput.classList.add('border-green-500', 'focus:ring-green-500', 'focus:border-green-500');
        passwordInput.classList.remove('border-red-500', 'focus:ring-red-500', 'focus:border-red-500');
        passwordValidIcon.classList.remove('hidden');
    } else {
        passwordInput.classList.add('border-red-500', 'focus:ring-red-500', 'focus:border-red-500');
        passwordInput.classList.remove('border-green-500', 'focus:ring-green-500', 'focus:border-green-500');
        passwordValidIcon.classList.add('hidden');
    }
    checkFormValidity();
});




//تفريغ الفورم عند الرجوع خطوة للوراء من المتصفح
window.onpageshow = function(event) {
    if (event.persisted) { // إذا تم تحميل الصفحة من ذاكرة التخزين المؤقت (عند الرجوع)
        // 1. إفراغ حقول الإدخال
        usernameInput.value = '';
        passwordInput.value = '';
        
        // 2. إعادة تعيين أنماط وأيقونات اسم المستخدم
        usernameInput.classList.remove(
            'border-green-500', 'focus:ring-green-500', 'focus:border-green-500',
            'border-red-500', 'focus:ring-red-500', 'focus:border-red-500'
        );
        usernameValidIcon.classList.add('hidden');
        
        // 3. إعادة تعيين أنماط وأيقونات كلمة المرور
        passwordInput.classList.remove(
            'border-green-500', 'focus:ring-green-500', 'focus:border-green-500',
            'border-red-500', 'focus:ring-red-500', 'focus:border-red-500'
        );
        passwordValidIcon.classList.add('hidden');
        
        // 4. إعادة تعيين حالة إظهار/إخفاء كلمة المرور
        passwordInput.type = 'password';
        eyeIcon.classList.remove('hidden');
        eyeOffIcon.classList.add('hidden');
    }
};












</script>
{% endblock %}
<!-- #endregion____________________________________________________نهاية محتوي الصفحة_______________________________________________________-->


<!-- #region_______________________________________________________بداية الفوتر ____________________________________________________________-->
    <!-- 
        {% block footer_block %}
        {% endblock footer_block %} 
    -->
<!-- #endregion____________________________________________________نهاية الفوتر ____________________________________________________________-->

